<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction and Overview • crunchtabs</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Introduction and Overview">
<meta property="og:description" content="crunchtabs">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">crunchtabs</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.4.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Codebooks.html">Generating Codebooks</a>
    </li>
    <li>
      <a href="../articles/FAQ.html">Frequently Asked Questions</a>
    </li>
    <li>
      <a href="../articles/Overview.html">Introduction and Overview</a>
    </li>
    <li>
      <a href="../articles/Theming.html">Theming</a>
    </li>
    <li>
      <a href="../articles/Tracking.html">Recontact and Tracking Reports</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/Crunch-io/crunchtabs/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Overview_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction and Overview</h1>
            
            <h4 class="date">Last Update: 2020-04-22</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/Crunch-io/crunchtabs/blob/master/vignettes/Overview.Rmd"><code>vignettes/Overview.Rmd</code></a></small>
      <div class="hidden name"><code>Overview.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>The <code>crunchtabs</code> package automates reporting for <a href="https://github.com/Crunch-io/rcrunch">crunch</a> datasets. It is designed to create toplines, cross tabulations and codebooks as tex (LaTeX), PDF or XLSX. The goal of this document is to provide you with enough information to go from nothing, to a client ready report, as fast as you can type. The examples included in this vignette use <code>crunch</code>’s built in pet dataset.</p>
<div id="installation" class="section level3">
<h3 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html">install_github</a></span><span class="op">(</span><span class="st">"Crunch-io/rcrunch"</span><span class="op">)</span> <span class="co"># If not already installed</span>
<span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html">install_github</a></span><span class="op">(</span><span class="st">"Crunch-io/crunchtabs"</span><span class="op">)</span></code></pre></div>
<p>Next, create a personal copy of the example data set for use with this vignette. This will ensure that you have the example dataset available to your account. A rudimentary understanding of the <code>crunch</code> R package is expected from readers of this document. Anyone with a <code>crunch</code> login should be able to follow along with the examples included here. If you are not familiar with <code>crunch</code>, the vignette is a good place to start <a href="https://crunch.io/r/crunch/articles/crunch.html">getting started</a> vignette.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Crunch-io/crunchtabs">crunchtabs</a></span><span class="op">)</span>
<span class="fu">login</span><span class="op">(</span><span class="op">)</span>
<span class="va">ds</span> <span class="op">&lt;-</span> <span class="fu">newExampledataset</span><span class="op">(</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="pdf-reports" class="section level2">
<h2 class="hasAnchor">
<a href="#pdf-reports" class="anchor"></a>PDF Reports</h2>
<p><code>crunchtabs</code> generates PDF reports by writing generated LaTeX to a file, then compiling that file. A significant amount of thought has gone into the default settings and it is recommended that you stick with them. However, there is a bounty of structural and thematic options that can be adjusted or manipulated to your requirements (see the Theme Arguments section of <code><a href="../reference/themeNew.html">?themeNew</a></code> for more information).</p>
<div id="create-a-topline" class="section level3">
<h3 class="hasAnchor">
<a href="#create-a-topline" class="anchor"></a>Create a Topline</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># library(crunchtabs)</span>
<span class="co"># login()</span>

<span class="va">ds</span> <span class="op">=</span> <span class="fu">loadDataset</span><span class="op">(</span><span class="st">"Example dataset"</span><span class="op">)</span>
<span class="co"># Use ds = newExampleDataset() if not found!</span>

<span class="va">toplines_summary</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/crosstabs.html">crosstabs</a></span><span class="op">(</span>dataset <span class="op">=</span> <span class="va">ds</span><span class="op">)</span>
<span class="fu"><a href="../reference/writeLatex.html">writeLatex</a></span><span class="op">(</span><span class="va">toplines_summary</span>, filename <span class="op">=</span> <span class="st">"output"</span>, pdf <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># output.pdf will be written </span></code></pre></div>
<blockquote>
<p>NOTE: Although called <code>crosstabs</code> this function serves both purposes by creating summary data for toplines and cross tabulation reports. There is no function called <code>toplines</code>.</p>
</blockquote>
<div class="figure">
<img src="https://raw.githubusercontent.com/Crunch-io/crunchtabs/main/vignettes/example-001-topline.png" alt=""><p class="caption">Topline Example from the Example Dataset</p>
</div>
</div>
<div id="create-a-cross-tabulation" class="section level3">
<h3 class="hasAnchor">
<a href="#create-a-cross-tabulation" class="anchor"></a>Create a Cross Tabulation</h3>
<p>The only additional step required for a cross tab report is to create a <code>banner</code> object. Then, setting it as the <code>banner</code> argument for the <code>crosstabs</code> function. The code block below creates a cross tabulation report that shows the type of pet(s) respondents own, for every question in the survey. Once you have run the code, open the resulting <code>output.pdf</code> file. Inside of the report you will find a cross tabulation of all questions by pet ownership.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># library(crunchtabs)</span>
<span class="co"># login()</span>

<span class="va">ds</span> <span class="op">=</span> <span class="fu">loadDataset</span><span class="op">(</span><span class="st">"Example dataset"</span><span class="op">)</span>
<span class="co"># Use ds = newExampleDataset() if not found!</span>

<span class="va">ct_banner</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/banner.html">banner</a></span><span class="op">(</span><span class="va">ds</span>, vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>`banner 1` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'allpets'</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">ct_summary</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/crosstabs.html">crosstabs</a></span><span class="op">(</span>dataset <span class="op">=</span> <span class="va">ds</span>, banner <span class="op">=</span> <span class="va">ct_banner</span><span class="op">)</span> <span class="co"># banner parameter set here</span>
<span class="fu"><a href="../reference/writeLatex.html">writeLatex</a></span><span class="op">(</span><span class="va">ct_summary</span>, filename <span class="op">=</span> <span class="st">"output"</span>, pdf <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># output.pdf will be written </span></code></pre></div>
<div class="figure">
<img src="https://raw.githubusercontent.com/Crunch-io/crunchtabs/main/vignettes/example-002-crosstabs.png" alt=""><p class="caption">Cross Tabulation Example from the Example Dataset</p>
</div>
</div>
</div>
<div id="excel" class="section level2">
<h2 class="hasAnchor">
<a href="#excel" class="anchor"></a>Excel</h2>
<p>To create documents in excel, the process is the same as that for creating PDF reports. However, in the last line of the example code block use <code>writeExcel</code> instead of <code>writeLatex</code> while also removing the <code>pdf = TRUE</code> argument. As with PDF reports, there are a large amount of options that can be set to adjust the look and feel of the resulting Excel spreadsheets (see the Theme Arguments section of <code><a href="../reference/themeNew.html">?themeNew</a></code> for more information).</p>
<blockquote>
<p>Unfortunately, toplines reports are not currently supported for Excel. However, this is a planned feature.</p>
</blockquote>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ... cross tab</span>
<span class="fu"><a href="../reference/writeExcel.html">writeExcel</a></span><span class="op">(</span><span class="va">ct_summary</span>, filename <span class="op">=</span> <span class="st">"output"</span><span class="op">)</span> <span class="co"># output.xlsx will be written </span>

<span class="co"># ... topline, not yet implemented</span>
<span class="co"># writeExcel(toplines_summary, filename = "output") # output.xlsx will be written </span></code></pre></div>
<div class="figure">
<img src="https://raw.githubusercontent.com/Crunch-io/crunchtabs/main/vignettes/example-003-excel-ct.png" alt=""><p class="caption">Cross Tabulation Excel Example from the Example Dataset</p>
</div>
<p>This package was designed to allow for some elements of style and structure to pass between the two formats. However, it should not be assumed that if something works in one format (Excel vs. PDF) it will work in another.</p>
</div>
<div id="structural-elements" class="section level2">
<h2 class="hasAnchor">
<a href="#structural-elements" class="anchor"></a>Structural Elements</h2>
<p>The default result is immediately useful for a researcher. However, there are other elements that require additions or adjustments before sharing with a client or internal stakeholders, such as:</p>
<ul>
<li>Including or excluding questions</li>
<li>Weighting our data</li>
<li>Calculating and including the margin of error</li>
<li>Adding titles</li>
<li>Using a table of contents</li>
<li>Customizing the theme</li>
<li>Specifying a field window (PDF Only)</li>
<li>Appending additional information (PDF Only)</li>
</ul>
<p>While some of these may be firmly within the realm of “theme” items, the package separates concerns based on which functions within <code>crunchtabs</code> adjust them. For this reason <em>structural elements</em> are typically arguments to the <code>writeLatex</code> or <code>writeExcel</code> function directly. There are many more theme elements available in the <code>themeNew</code> function.</p>
<div id="including-or-excluding-questions" class="section level3">
<h3 class="hasAnchor">
<a href="#including-or-excluding-questions" class="anchor"></a>Including or Excluding Questions</h3>
<p>By default, the <code>crosstabs</code> function attempts to create a topline or crosstab for all of the aliases that are visible to it in the dataset (<code><a href="https://rdrr.io/r/base/names.html">names(dataset)</a></code>). Creating a subset requires nothing more than a character vector with the aliases that you are interested in including in the report.</p>
<blockquote>
<p>An <em>alias</em> is a name used to reference a question asked in a survey. For example, <code>q1</code> references the question “What is your favorite pet?”. For more information see <a href="https://crunch.io/r/crunch/articles/variables.html#a-rose-by-any-other-moniker-names-and-aliases">aliases in crunch</a></p>
</blockquote>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># library(crunchtabs)</span>
<span class="co"># login()</span>

<span class="va">ds</span> <span class="op">=</span> <span class="fu">loadDataset</span><span class="op">(</span><span class="st">"Example dataset"</span><span class="op">)</span>
<span class="co"># Use ds = newExampleDataset() if not found!</span>

<span class="va">toplines_summary</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/crosstabs.html">crosstabs</a></span><span class="op">(</span>
  dataset <span class="op">=</span> <span class="va">ds</span>, 
  vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"allpets"</span>, <span class="st">"q1"</span>, <span class="st">"petloc"</span><span class="op">)</span>
<span class="op">)</span>

<span class="fu"><a href="../reference/writeLatex.html">writeLatex</a></span><span class="op">(</span><span class="va">toplines_summary</span>, filename <span class="op">=</span> <span class="st">"output"</span>, pdf <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># output.pdf will be written </span></code></pre></div>
<p>By setting the <code>vars</code> argument, you can limit the questions that are output by your call to <code>writeLatex</code> or <code>writeExcel</code>. Given that this argument is a character vector, it can also be useful to use <em>exclusions</em> if your dataset has a large number of questions:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ...</span>
<span class="va">toplines_summary</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/crosstabs.html">crosstabs</a></span><span class="op">(</span>
  dataset <span class="op">=</span> <span class="va">ds</span>, 
  vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sets.html">setdiff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">ds</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"country"</span>,<span class="st">"petloc"</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span>
<span class="co"># ...</span></code></pre></div>
<p>A common usage pattern is to define the variables as their own R object and then assign that object to the parameter. Remember that if you change the vector of included question aliases you must also re-run the <code>crosstabs</code> function.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">topline_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"allpets"</span>, <span class="st">"q1"</span>, <span class="st">"petloc"</span><span class="op">)</span>
<span class="va">topline_summary</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/crosstabs.html">crosstabs</a></span><span class="op">(</span>dataset <span class="op">=</span> <span class="va">ds</span>, vars <span class="op">=</span> <span class="va">topline_vars</span><span class="op">)</span>
<span class="fu"><a href="../reference/writeLatex.html">writeLatex</a></span><span class="op">(</span><span class="va">toplines_summary</span>, filename <span class="op">=</span> <span class="st">"output"</span><span class="op">)</span> <span class="co"># output.pdf will be written </span></code></pre></div>
</div>
<div id="recoding-and-relabelling-banners" class="section level3">
<h3 class="hasAnchor">
<a href="#recoding-and-relabelling-banners" class="anchor"></a>Recoding and Relabelling Banners</h3>
<p>Sometimes the names presented in the banner of a crosstab are not desirable, too long, or lacking context. The <code>crosstabs</code> function has the built-in ability to recode the text labels. In the following example, the names of the pets are changed from Cat, Dog, or Bird, to their Spanish equivalents.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># library(crunchtabs)</span>
<span class="co"># login()</span>

<span class="va">ds</span> <span class="op">=</span> <span class="fu">loadDataset</span><span class="op">(</span><span class="st">"Example dataset"</span><span class="op">)</span>
<span class="co"># Use ds = newExampleDataset() if not found!</span>

<span class="va">ct_banner</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/banner.html">banner</a></span><span class="op">(</span>
  <span class="va">ds</span>, 
  vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>`banner 1` <span class="op">=</span> <span class="st">'allpets'</span><span class="op">)</span>, 
  recodes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"allpets"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>Cat <span class="op">=</span> <span class="st">'Gato'</span>, Dog <span class="op">=</span> <span class="st">'Perro'</span>, Bird <span class="op">=</span> <span class="st">'Pájaro'</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span>
<span class="va">ct_summary</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/crosstabs.html">crosstabs</a></span><span class="op">(</span>dataset <span class="op">=</span> <span class="va">ds</span>, banner <span class="op">=</span> <span class="va">ct_banner</span><span class="op">)</span> <span class="co"># banner parameter set here</span>
<span class="fu"><a href="../reference/writeLatex.html">writeLatex</a></span><span class="op">(</span><span class="va">ct_summary</span>, filename <span class="op">=</span> <span class="st">"output"</span>, pdf <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># output.pdf will be written </span></code></pre></div>
<div class="figure">
<img src="https://raw.githubusercontent.com/Crunch-io/crunchtabs/main/vignettes/example-004-ct-recode.png" alt=""><p class="caption">Cross Tabulation Recode</p>
</div>
<p>Notice that there is still “All pets owned”. To change the column headings, use the recode argument. To change the group header use the labels argument.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># library(crunchtabs)</span>
<span class="co"># login()</span>

<span class="va">ds</span> <span class="op">=</span> <span class="fu">loadDataset</span><span class="op">(</span><span class="st">"Example dataset"</span><span class="op">)</span>
<span class="co"># Use ds = newExampleDataset() if not found!</span>

<span class="va">ct_banner</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/banner.html">banner</a></span><span class="op">(</span>
  <span class="va">ds</span>, 
  vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>`banner 1` <span class="op">=</span> <span class="st">'allpets'</span><span class="op">)</span>, 
  labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>allpets <span class="op">=</span> <span class="st">"Todas las mascotas"</span><span class="op">)</span>, <span class="co"># </span>
  recodes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"allpets"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>Cat <span class="op">=</span> <span class="st">'Gato'</span>, Dog <span class="op">=</span> <span class="st">'Perro'</span>, Bird <span class="op">=</span> <span class="st">'Pájaro'</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">ct_summary</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/crosstabs.html">crosstabs</a></span><span class="op">(</span>dataset <span class="op">=</span> <span class="va">ds</span>, banner <span class="op">=</span> <span class="va">ct_banner</span><span class="op">)</span> 
<span class="fu"><a href="../reference/writeLatex.html">writeLatex</a></span><span class="op">(</span><span class="va">ct_summary</span>, filename <span class="op">=</span> <span class="st">"output"</span>, pdf <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># output.pdf will be written </span></code></pre></div>
<p>Now, our header has been re-labeled as “Todas las mascotas”.</p>
<div class="figure">
<img src="https://raw.githubusercontent.com/Crunch-io/crunchtabs/main/vignettes/example-005-ct-relabel.png" alt=""><p class="caption">Cross Tabulation Relabel</p>
</div>
</div>
<div id="weighting-data" class="section level3">
<h3 class="hasAnchor">
<a href="#weighting-data" class="anchor"></a>Weighting Data</h3>
<p>Most research work flows include a need to apply some kind of weighting scheme. Weighting is not applied automatically by default when running the <code>crosstabs</code> function. If your dataset has already been weighted earlier in your script, you do not need to specify a weighting variable. (you can check this with: <code>weight(ds)</code>). In the example below, the dataset does not have an existing weighting scheme so we must create one. Most datasets in the wild will already have one or more weighting variables available. You can check the aliases of these weighting variables by using <code>weightingVariables(ds)</code>.</p>
<p>These data will be weighted so that they are is 75% cat lovers, 15% dog lovers and 10% bird lovers, with the <em>extremely plausible</em> assumption that almost everyone is a cat lover at heart.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># library(crunchtabs)</span>
<span class="co"># login()</span>

<span class="va">ds</span> <span class="op">=</span> <span class="fu">loadDataset</span><span class="op">(</span><span class="st">"Example dataset"</span><span class="op">)</span>
<span class="co"># Use ds = newExampleDataset() if not found!</span>

<span class="fu">weightVariables</span><span class="op">(</span><span class="va">ds</span><span class="op">)</span> <span class="co"># NULL, no weighting variables</span>

<span class="va">ds</span><span class="op">$</span><span class="va">weight</span> <span class="op">=</span> <span class="fu">makeWeight</span><span class="op">(</span><span class="va">ds</span><span class="op">$</span><span class="va">q1</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.75</span>, <span class="fl">0.15</span>, <span class="fl">0.10</span><span class="op">)</span>, name <span class="op">=</span> <span class="st">"weight"</span><span class="op">)</span>
<span class="fu">modifyWeightVariables</span><span class="op">(</span><span class="va">ds</span>, <span class="st">"weight"</span><span class="op">)</span> <span class="co"># Assign "weight" as the weighting variable</span>

<span class="va">ct_banner</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/banner.html">banner</a></span><span class="op">(</span>
  <span class="va">ds</span>, 
  vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>`banner 1` <span class="op">=</span> <span class="st">'allpets'</span><span class="op">)</span>
<span class="op">)</span>

<span class="va">ct_summary</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/crosstabs.html">crosstabs</a></span><span class="op">(</span>
  dataset <span class="op">=</span> <span class="va">ds</span>, 
  weight <span class="op">=</span> <span class="st">'weight'</span>, <span class="co"># Specify your weight variable explicitly</span>
  banner <span class="op">=</span> <span class="va">ct_banner</span>
<span class="op">)</span> 
<span class="fu"><a href="../reference/writeLatex.html">writeLatex</a></span><span class="op">(</span><span class="va">ct_summary</span>, filename <span class="op">=</span> <span class="st">"output"</span>, pdf <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> </code></pre></div>
<p>After running <code>modifyWeight</code> our dataset now has a weighting variable assigned. You can verify this with <code>weightVariables(ds)</code>.</p>
<div class="figure">
<img src="https://raw.githubusercontent.com/Crunch-io/crunchtabs/main/vignettes/example-006-ct-weight.png" alt=""><p class="caption">Cross Tabulation Relabel</p>
</div>
<blockquote>
<p>NOTE: In Crunch, a “viewer” of a dataset does not have access to the individuals rows and cannot weight data or calculate margin of error using the R crunch package.</p>
</blockquote>
</div>
<div id="calculating-and-displaying-margin-of-error" class="section level3">
<h3 class="hasAnchor">
<a href="#calculating-and-displaying-margin-of-error" class="anchor"></a>Calculating and Displaying Margin of Error</h3>
<p>Communicating the margin of error for your dataset is a typical requirement faced by all researchers. In the example below, margin of error is calculated using the weighting variable in the previous section (Weighting Data). There are a variety of ways for calculating margin of error depending on your survey. A very simple abstraction using your weight variable and the weighted base is provided as an example, below.</p>
<p>If you are inheriting a project from someone you will likely see some variation of the function below included in the scripts they currently use to create a crosstab.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Margin of Error function</span>
<span class="va">moe</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">weightvar</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">weights</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span><span class="op">(</span><span class="va">weightvar</span><span class="op">)</span>
  <span class="va">n</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">weights</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
  <span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">qt</a></span><span class="op">(</span><span class="fl">0.975</span>, <span class="va">n</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> 
    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span>
      <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="op">(</span>
        <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">weights</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">/</span>
          <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">weights</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
        <span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>
      <span class="op">)</span> <span class="op">*</span> 
    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="fl">4</span> <span class="op">*</span> <span class="va">n</span><span class="op">)</span><span class="op">)</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span>
<span class="op">}</span>

<span class="va">include_moe</span> <span class="op">=</span> <span class="fu">moe</span><span class="op">(</span><span class="va">ds</span><span class="op">$</span><span class="va">weight</span><span class="op">)</span>

<span class="fu"><a href="../reference/writeLatex.html">writeLatex</a></span><span class="op">(</span>
  <span class="va">ct_summary</span>, 
  filename <span class="op">=</span> <span class="st">"output"</span>, 
  pdf <span class="op">=</span> <span class="cn">TRUE</span>,
  moe <span class="op">=</span> <span class="va">include_moe</span>
<span class="op">)</span> </code></pre></div>
<p>In the example above the margin of error has been placed near the top of the page just below the title. A margin of error of 43.9% is not a desirable outcome for a survey. Thankfully, this is just an example.</p>
<div class="figure">
<img src="https://raw.githubusercontent.com/Crunch-io/crunchtabs/main/vignettes/example-007-ct-moe.png" alt=""><p class="caption">Cross Tabulation Relabel</p>
</div>
</div>
<div id="adding-titles" class="section level3">
<h3 class="hasAnchor">
<a href="#adding-titles" class="anchor"></a>Adding Titles</h3>
<p>The default title behavior assigns the dataset name as the title on each page of the report. Often the internal reference used to denote a data set is not well aligned or appropriate for other stakeholders. You can customize this output by providing a title and a subtitle as in the example below.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/writeLatex.html">writeLatex</a></span><span class="op">(</span>
  <span class="va">ct_summary</span>, 
  filename <span class="op">=</span> <span class="st">"output"</span>, 
  title <span class="op">=</span> <span class="st">"The Amazing Pet Survey"</span>,
  subtitle <span class="op">=</span> <span class="st">"Everyone Loves Cats"</span>,
  pdf <span class="op">=</span> <span class="cn">TRUE</span>,
  moe <span class="op">=</span> <span class="va">include_moe</span>
<span class="op">)</span> </code></pre></div>
<div class="figure">
<img src="https://raw.githubusercontent.com/Crunch-io/crunchtabs/main/vignettes/example-008-ct-titles.png" alt=""><p class="caption">Including Margin of Error</p>
</div>
</div>
<div id="including-a-table-of-contents" class="section level3">
<h3 class="hasAnchor">
<a href="#including-a-table-of-contents" class="anchor"></a>Including a Table of Contents</h3>
<p>A small change to our call to <code>writeLatex</code> or <code>writeExcel</code> allows for the inclusion of a table of contents. In both document types this creates a “linked” table of contents that allows for navigation to the table of interest when the table of contents item is clicked.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/writeLatex.html">writeLatex</a></span><span class="op">(</span>
  <span class="va">ct_summary</span>, 
  <span class="co"># ...,</span>
  table_of_contents <span class="op">=</span> <span class="cn">TRUE</span>,
  pdf <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span> 

<span class="fu"><a href="../reference/writeExcel.html">writeExcel</a></span><span class="op">(</span>
  <span class="va">ct_summary</span>, 
  <span class="co"># ...,</span>
  table_of_contents <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span></code></pre></div>
<div class="figure">
<img src="https://raw.githubusercontent.com/Crunch-io/crunchtabs/main/vignettes/example-011-pdf-toc.png" alt=""><p class="caption">PDF: Table of Contents</p>
</div>
<div class="figure">
<img src="https://raw.githubusercontent.com/Crunch-io/crunchtabs/main/vignettes/example-011-xlsx-toc.png" alt=""><p class="caption">Excel: Table of Contents</p>
</div>
</div>
<div id="customizing-theme" class="section level3">
<h3 class="hasAnchor">
<a href="#customizing-theme" class="anchor"></a>Customizing Theme</h3>
<p>There are a large amount of theme options available for both PDF and Excel reports. Below is a cursory example. It is recommended that you review <code><a href="../reference/themeNew.html">?themeNew</a></code> for more specific details about all of the elements that can be changed.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">myTheme</span> <span class="op">=</span> <span class="fu"><a href="../reference/themeNew.html">themeNew</a></span><span class="op">(</span>
  <span class="va">...</span>
<span class="op">)</span>

<span class="fu"><a href="../reference/writeLatex.html">writeLatex</a></span><span class="op">(</span>
  <span class="va">ct_summary</span>, 
  filename <span class="op">=</span> <span class="st">"output"</span>, 
  title <span class="op">=</span> <span class="st">"The Amazing Pet Survey"</span>,
  subtitle <span class="op">=</span> <span class="st">"Everyone Loves Cats"</span>,
  theme <span class="op">=</span> <span class="va">myTheme</span>,
  pdf <span class="op">=</span> <span class="cn">TRUE</span>,
  moe <span class="op">=</span> <span class="va">include_moe</span>
<span class="op">)</span> </code></pre></div>
</div>
<div id="specifying-a-field-window-pdf-only" class="section level3">
<h3 class="hasAnchor">
<a href="#specifying-a-field-window-pdf-only" class="anchor"></a>Specifying a field window (PDF Only)</h3>
<p>There are two common patterns for specifying a field window. The first is to specify it using the <code>field_period</code> argument of the <code>writeLatex</code> function. The second is to set your field window as the <code>subtitle</code>. In the <em>Adding Titles</em> section, the <code>subtitle</code> argument accepts arbitrary text.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/writeLatex.html">writeLatex</a></span><span class="op">(</span>
  <span class="co"># ...</span>
  field_period <span class="op">=</span> <span class="st">"2020-02-04 - 2020-03-04"</span>
<span class="op">)</span> </code></pre></div>
<div class="figure">
<img src="https://raw.githubusercontent.com/Crunch-io/crunchtabs/main/vignettes/example-008a-ct-field-date.png" alt=""><p class="caption">Including a Field Period</p>
</div>
</div>
<div id="appending-text-pdf-only" class="section level3">
<h3 class="hasAnchor">
<a href="#appending-text-pdf-only" class="anchor"></a>Appending Text (PDF Only)</h3>
<p>The string passed to <code>append_text</code> will be visible on the last page of your report.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/writeLatex.html">writeLatex</a></span><span class="op">(</span>
  <span class="co"># ...</span>
  append_text <span class="op">=</span> <span class="st">"Field Window: 2020-02-04 - 2020-03-04"</span>
<span class="op">)</span> </code></pre></div>
<div class="figure">
<img src="https://raw.githubusercontent.com/Crunch-io/crunchtabs/main/vignettes/example-009-ct-append.png" alt=""><p class="caption">Appending Basic Text</p>
</div>
<p>You can also append much larger chunks of text like a disclosure, analysis, or other marketing copy that is required for all of your documents. A typical workflow here is to create a .tex fragment file or an R string object that includes your copy. Tex makes significant use of the <code>\</code> character. In R, you must <em>escape</em> the backslash with an additional backslash. In the example below you see <code>\begin</code> becomes <code>\\begin</code> and a new line <code>\\</code> becomes <code>\\\\</code>.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">myAppend</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span>  
<span class="st">"

\\begin{tabular*}{5.5in}{p{2in}p{4in}}
\\textbf{Sponsorship}   &amp;    \\emph{CLIENTNAME} \\\\
\\addlinespace \\addlinespace
\\textbf{Fieldwork}    &amp;    COMPANYNAME \\\\
\\addlinespace \\addlinespace
\\textbf{Interviewing Dates} &amp;  2020-04-04 \\\\
\\addlinespace \\addlinespace
\\textbf{Target population}  &amp;  US Adult Population \\\\
\\end{tabular*}

"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/writeLatex.html">writeLatex</a></span><span class="op">(</span>
  <span class="va">ct_summary</span>, 
  filename <span class="op">=</span> <span class="st">"output"</span>, 
  pdf <span class="op">=</span> <span class="cn">TRUE</span>,
  append_text <span class="op">=</span> <span class="va">myAppend</span>
<span class="op">)</span> </code></pre></div>
<div class="figure">
<img src="https://raw.githubusercontent.com/Crunch-io/crunchtabs/main/vignettes/example-010-ct-append.png" alt=""><p class="caption">Appending Arbitrary Tex</p>
</div>
</div>
</div>
<div id="seeking-commentary" class="section level2">
<h2 class="hasAnchor">
<a href="#seeking-commentary" class="anchor"></a>Seeking Commentary</h2>
<p>We are always seeking feedback on this and other documents or features of <code>crunchtabs</code>. Feel free to leave an <a href="https://github.com/Crunch-io/crunchtabs/issues">issue</a></p>
<blockquote>
<p>No pets were harmed in the making of this vignette.</p>
</blockquote>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Persephone Tsebelis, Kamil Sedrowicz, Neal Richardson, Brandon Bertelsen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
